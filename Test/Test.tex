% 若编译失败，且生成 .synctex(busy) 辅助文件，可能有两个原因：
% 1. 需要插入的图片不存在：Ctrl + F 搜索 'figure' 将这些代码注释/删除掉即可
% 2. 路径/文件名含中文或空格：更改路径/文件名即可

% --------------------- 文章宏包及相关设置 --------------------- %
% >> ------------------ 文章宏包及相关设置 ------------------ << %
% 设定文章类型与编码格式
\documentclass[UTF8]{report}		
\usepackage{media9}
%\usepackage{multimedia}
% 本文特殊宏包
\usepackage{siunitx} % 埃米单位

% 本文特殊宏定义
\def\Re{\mathrm{Re}\,}
\def\Im{\mathrm{Im}\,}

% 自定义宏定义
\def\N{\mathbb{N}}
\def\F{\mathbb{F}}
\def\Z{\mathbb{Z}}
\def\Q{\mathbb{Q}}
\def\R{\mathbb{R}}
\def\C{\mathbb{C}}
\def\T{\mathbb{T}}
\def\S{\mathbb{S}}
\def\A{\mathbb{A}}
\def\I{\mathscr{I}}
\def\Arg{\mathrm{Arg}\,}
\def\d{\mathrm{d}}
\def\p{\partial}


% 导入基本宏包
\usepackage[UTF8]{ctex}     % 设置文档为中文语言
\usepackage{hyperref}  % 宏包：自动生成超链接 (此宏包与标题中的数学环境冲突)
\hypersetup{
    colorlinks=true,    % false:边框链接 ; true:彩色链接
    citecolor={blue},    % 文献引用颜色
    linkcolor={blue},   % 目录 (我们在目录处单独设置)，公式，图表，脚注等内部链接颜色
    urlcolor={magenta},    % 网页 URL 链接颜色，包括 \href 中的 text
    % cyan 浅蓝色 
    % magenta 洋红色
    % yellow 黄色
    % black 黑色
    % white 白色
    % red 红色
    % green 绿色
    % blue 蓝色
    % gray 灰色
    % darkgray 深灰色
    % lightgray 浅灰色
    % brown 棕色
    % lime 石灰色
    % olive 橄榄色
    % orange 橙色
    % pink 粉红色
    % purple 紫色
    % teal 蓝绿色
    % violet 紫罗兰色
}

% \usepackage{docmute}    % 宏包：子文件导入时自动去除导言区，用于主/子文件的写作方式，\include{./51单片机笔记}即可。注：启用此宏包会导致.tex文件capacity受限。
\usepackage{amsmath}    % 宏包：数学公式
\usepackage{mathrsfs}   % 宏包：提供更多数学符号
\usepackage{amssymb}    % 宏包：提供更多数学符号
\usepackage{pifont}     % 宏包：提供了特殊符号和字体
\usepackage{extarrows}  % 宏包：更多箭头符号
\usepackage{multicol}   % 宏包：支持多栏 


% 文章页面margin设置
\usepackage[a4paper]{geometry}
    \geometry{top=1in}  % 1 inch= 2.46 cm, 0.75 inch = 1.85 cm
    \geometry{bottom=1in}
    \geometry{left=0.75in}
    \geometry{right=0.75in}   % 设置上下左右页边距
    \geometry{marginparwidth=1.75cm}    % 设置边注距离（注释、标记等）

% 配置数学环境
\usepackage{amsthm} % 宏包：数学环境配置
% theorem-line 环境自定义
    \newtheoremstyle{MyLineTheoremStyle}% <name>
        {11pt}% <space above>
        {11pt}% <space below>
        {\kaishu}% <body font> 使用默认正文字体
        {}% <indent amount>
        {\bfseries}% <theorem head font> 设置标题项为加粗
        {：}% <punctuation after theorem head>
        {.5em}% <space after theorem head>
        {\textbf{#1}\thmnumber{#2}\ \ (\,\textbf{#3}\,)}% 设置标题内容顺序
    \theoremstyle{MyLineTheoremStyle} % 应用自定义的定理样式
    \newtheorem{LineTheorem}{Theorem.\,}
% theorem-block 环境自定义
    \newtheoremstyle{MyBlockTheoremStyle}% <name>
        {11pt}% <space above>
        {11pt}% <space below>
        {}% <body font> 使用默认正文字体
        {}% <indent amount>
        {\bfseries}% <theorem head font> 设置标题项为加粗
        {：\\ \indent}% <punctuation after theorem head>
        {.5em}% <space after theorem head>
        {\textbf{#1}\thmnumber{#2}\ \ (\,\textbf{#3}\,)}% 设置标题内容顺序
    \theoremstyle{MyBlockTheoremStyle} % 应用自定义的定理样式
    \newtheorem{BlockTheorem}[LineTheorem]{Theorem.\,} % 使用 LineTheorem 的计数器
% definition 环境自定义
    \newtheoremstyle{MySubsubsectionStyle}% <name>
        {11pt}% <space above>
        {11pt}% <space below>
        {}% <body font> 使用默认正文字体
        {}% <indent amount>
        {\bfseries}% <theorem head font> 设置标题项为加粗
        {：\\ \indent}% <punctuation after theorem head>
        {0pt}% <space after theorem head>
        {\textbf{#3}}% 设置标题内容顺序
    \theoremstyle{MySubsubsectionStyle} % 应用自定义的定理样式
    \newtheorem{definition}{}

%宏包：有色文本框（proof环境）及其设置
\usepackage[dvipsnames,svgnames]{xcolor}    %设置插入的文本框颜色
\usepackage[strict]{changepage}     % 提供一个 adjustwidth 环境
\usepackage{framed}     % 实现方框效果
    \definecolor{graybox_color}{rgb}{0.95,0.95,0.96} % 文本框颜色。修改此行中的 rgb 数值即可改变方框纹颜色，具体颜色的rgb数值可以在网站https://colordrop.io/ 中获得。（截止目前的尝试还没有成功过，感觉单位不一样）（找到喜欢的颜色，点击下方的小眼睛，找到rgb值，复制修改即可）
    \newenvironment{graybox}{%
    \def\FrameCommand{%
    \hspace{1pt}%
    {\color{gray}\small \vrule width 2pt}%
    {\color{graybox_color}\vrule width 4pt}%
    \colorbox{graybox_color}%
    }%
    \MakeFramed{\advance\hsize-\width\FrameRestore}%
    \noindent\hspace{-4.55pt}% disable indenting first paragraph
    \begin{adjustwidth}{}{7pt}%
    \vspace{2pt}\vspace{2pt}%
    }
    {%
    \vspace{2pt}\end{adjustwidth}\endMakeFramed%
    }

% 外源代码插入设置
% matlab 代码插入设置
\usepackage{matlab-prettifier}
    \lstset{style=Matlab-editor}    % 继承 matlab 代码高亮 , 此行不能删去
\usepackage[most]{tcolorbox} % 引入tcolorbox包 
\usepackage{listings} % 引入listings包
    \tcbuselibrary{listings, skins, breakable}
    \newfontfamily\codefont{Consolas} % 定义需要的 codefont 字体
    \lstdefinestyle{MatlabStyle_inc}{   % 插入代码的样式
        language=Matlab,
        basicstyle=\small\ttfamily\codefont,    % ttfamily 确保等宽 
        breakatwhitespace=false,
        breaklines=true,
        captionpos=b,
        keepspaces=true,
        numbers=left,
        numbersep=15pt,
        showspaces=false,
        showstringspaces=false,
        showtabs=false,
        tabsize=2,
        xleftmargin=15pt,   % 左边距
        %frame=single, % single 为包围式单线框
        frame=shadowbox,    % shadowbox 为带阴影包围式单线框效果
        %escapeinside=``,   % 允许在代码块中使用 LaTeX 命令 (此行无用)
        %frameround=tttt,    % tttt 表示四个角都是圆角
        framextopmargin=0pt,    % 边框上边距
        framexbottommargin=0pt, % 边框下边距
        framexleftmargin=5pt,   % 边框左边距
        framexrightmargin=5pt,  % 边框右边距
        rulesepcolor=\color{red!20!green!20!blue!20}, % 阴影框颜色设置
        %backgroundcolor=\color{blue!10}, % 背景颜色
    }
    \lstdefinestyle{MatlabStyle_src}{   % 插入代码的样式
        language=Matlab,
        basicstyle=\small\ttfamily\codefont,    % ttfamily 确保等宽 
        breakatwhitespace=false,
        breaklines=true,
        captionpos=b,
        keepspaces=true,
        numbers=left,
        numbersep=15pt,
        showspaces=false,
        showstringspaces=false,
        showtabs=false,
        tabsize=2,
    }
    \newtcblisting{matlablisting}{
        %arc=2pt,        % 圆角半径
        % 调整代码在 listing 中的位置以和引入文件时的格式相同
        top=0pt,
        bottom=0pt,
        left=-5pt,
        right=-5pt,
        listing only,   % 此句不能删去
        listing style=MatlabStyle_src,
        breakable,
        colback=white,   % 选一个合适的颜色
        colframe=black!0,   % 感叹号后跟不透明度 (为 0 时完全透明)
    }
    \lstset{
        style=MatlabStyle_inc,
    }

% table 支持
\usepackage{booktabs}   % 宏包：三线表
\usepackage{tabularray} % 宏包：表格排版
\usepackage{longtable}  % 宏包：长表格
\usepackage{diagbox}    % 宏包：表头斜线

% figure 设置
\usepackage{graphicx}  % 支持 jpg, png, eps, pdf 图片 
\usepackage{svg}       % 支持 svg 图片
    \svgsetup{
        % 指向 inkscape.exe 的路径
        %inkscapeexe = C:/aa_MySame/inkscape/bin/inkscape.exe, 
        inkscapeexe = C:/aa_MySame/inkscape/bin/inkscape.exe,  
        % 一定程度上修复导入后图片文字溢出几何图形的问题
        inkscapelatex = false                 
    }

% 图表进阶设置
\usepackage{caption}    % 图注、表注
    \captionsetup[figure]{name=图}  
    \captionsetup[table]{name=表}
    \captionsetup{
            labelfont=bf, % 设置标签为粗体
            textfont=bf,  % 设置文本为粗体
            font=small  
        }
\usepackage{float}     % 图表位置浮动设置 
\usepackage{subcaption} % subfigure 子图支持

% 圆圈序号自定义
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{\node[shape=circle,draw,inner sep=0.8pt, line width = 0.03em] (char) {\small \bfseries #1};}}   % TikZ solution

% 列表设置
\usepackage{enumitem}   % 宏包：列表环境设置
    \setlist[enumerate]{
        label=(\arabic*) ,   % 设置序号样式为 (1) (2) (3)
        ref=\arabic*, % 如果需要引用列表项，这将决定引用格式（这里仍然使用数字）
        itemsep=0pt, parsep=0pt, topsep=0pt, partopsep=0pt, leftmargin=3.5em} 
    \setlist[itemize]{itemsep=0pt, parsep=0pt, topsep=0pt, partopsep=0pt, leftmargin=3.5em}
    \newlist{circledenum}{enumerate}{1} % 创建一个新的枚举环境  
    \setlist[circledenum,1]{  
        label=\protect\circled{\arabic*}, % 使用 \arabic* 来获取当前枚举计数器的值，并用 \circled 包装它  
        ref=\arabic*, % 如果需要引用列表项，这将决定引用格式（这里仍然使用数字）
        itemsep=0pt, parsep=0pt, topsep=0pt, partopsep=0pt, leftmargin=3.5em
    }  

% 其它设置
% 脚注设置
    \renewcommand\thefootnote{\ding{\numexpr171+\value{footnote}}}
% 参考文献引用设置
    \bibliographystyle{unsrt}   % 设置参考文献引用格式为unsrt
    \newcommand{\upcite}[1]{\textsuperscript{\cite{#1}}}     % 自定义上角标式引用
% 文章序言设置
    \newcommand{\cnabstractname}{序言}
    \newenvironment{cnabstract}{%
        \par\Large
        \noindent\mbox{}\hfill{\bfseries \cnabstractname}\hfill\mbox{}\par
        \vskip 2.5ex
        }{\par\vskip 2.5ex}

% 文章默认字体设置
\usepackage{fontspec}   % 宏包：字体设置
    \setmainfont{SimSun}    % 设置中文字体为宋体字体
    \setCJKmainfont[AutoFakeBold=3]{SimSun} % 设置加粗字体为 SimSun 族，AutoFakeBold 可以调整字体粗细
    \setmainfont{Times New Roman} % 设置英文字体为 Times New Roman

% 各级标题自定义设置
\usepackage{titlesec}   
    % chapter 标题自定义设置
    \titleformat{\chapter}[hang]{\normalfont\huge\bfseries\centering}{第\,\thechapter\,章}{20pt}{}
    \titlespacing*{\chapter}{0pt}{-20pt}{20pt} % 控制上方空白的大小
    % section 标题自定义设置 
    \titleformat{\section}[hang]{\normalfont\Large\bfseries}{§\,\thesection\,}{8pt}{}
% subsubsection 标题自定义设置
%\titleformat{\subsubsection}[hang]{\normalfont\bfseries}{}{8pt}{}

% --------------------- 文章宏包及相关设置 --------------------- %
% >> ------------------ 文章宏包及相关设置 ------------------ << %

% ------------------------ 文章信息区 ------------------------ %
% ------------------------ 文章信息区 ------------------------ %
% 页眉页脚设置
\usepackage{fancyhdr}   %宏包：页眉页脚设置
    \pagestyle{fancy}
    \fancyhf{}
    \cfoot{\thepage}
    \renewcommand\headrulewidth{1pt}
    \renewcommand\footrulewidth{0pt}
    \lhead{2024.8 -- 2025.1} 
    \chead{光学笔记（Optics Notes）}    
    \rhead{dingyi233@mails.ucas.ac.cn}
%文档信息设置
\title{光学笔记\\Optics Notes}
\author{丁毅\\ \footnotesize 中国科学院大学，北京 100049\\ Yi Ding \\ \footnotesize University of Chinese Academy of Sciences, Beijing 100049, China}
\date{\footnotesize 2024.8 -- 2025.1}
% ------------------------ 文章信息区 ------------------------ %
% ------------------------ 文章信息区 ------------------------ %

% 开始编辑文章

\begin{document} 
\zihao{5}             % 设置全文字号大小, -4 为小四, 5 为五号

% ------------------------ 封面序言与目录 ------------------------ %
% >> --------------------- 封面序言与目录 --------------------- << %
% 封面
\maketitle\newpage  
\pagenumbering{Roman} % 页码为大写罗马数字
\thispagestyle{fancy}   % 显示页码、页眉等

% 序言
\begin{cnabstract}\normalsize 
本文为笔者本科时的“光学”课程笔记（Optics Notes, 2024.8-2025.1）。
课程信息、作业和相关资料可在笔者的个人网站上找到: \href{https://yidingg.github.io/YiDingg/\#/Notes/Phisics/OpticsNotes}{Notes > Phisics > Optics (https://yidingg.github.io/YiDingg/\#/Notes/Phisics/OpticsNotes)}，也可以到网址 {\color{red}（课程结束后更新）} 下载全部相关资料。
由于个人学识浅陋，认识有限，文中难免有不妥甚至错误之处，望读者不吝指正。读者可以到笔者的 \href{https://github.com/YiDingg/LatexNotes}{GitHub 笔记库 (https://github.com/YiDingg/LatexNotes)} 上提 issue，也可以将错误发送到我的邮箱 {\color{blue}\ dingyi233@mails.ucas.ac.cn}，衷心感谢。

在正式学习之前，建议先跳转至附录 A “波理论”部分，学习必要的前置知识（否则可能难以理解）。
\end{cnabstract}
\addcontentsline{toc}{chapter}{序言} % 手动添加为目录

% 目录
\setcounter{tocdepth}{1}                % 目录深度（chapter 下 为 1 时显示到section）
\tableofcontents                        % 目录页
\addcontentsline{toc}{chapter}{目录}    % 手动添加此页为目录
\thispagestyle{fancy}                   % 显示页码、页眉等 

% 收尾工作
\newpage    
\pagenumbering{arabic} 

% >> --------------------- 封面序言与目录 --------------------- << %
% ------------------------ 封面序言与目录 ------------------------ %

\chapter{光学导言}\thispagestyle{fancy}

\section{光学发展简史（略）}


% --------------------------- 附录 --------------------------- %
% >> ------------------------ 附录 ------------------------ << %


\newpage
\appendix
% chapter 标题自定义设置
\titleformat{\chapter}[hang]{\normalfont\huge\bfseries\centering}{}{20pt}{}
\titlespacing*{\chapter}{0pt}{-25pt}{8pt} % 控制上方空白的大小
% section 标题自定义设置 
\titleformat{\section}[hang]{\normalfont\centering\Large\bfseries}{\thesection}{8pt}{}

% 附录 A
\chapter*{附录 A\hspace*{20pt} 波理论}
\setcounter{chapter}{1} 
\setcounter{equation}{0}    % 重置公式计数器   
\addcontentsline{toc}{chapter}{附录 A\hspace*{6pt} 波理论}   
\thispagestyle{fancy} 
\setcounter{section}{0}   
\renewcommand\thesection{A.\arabic{section}}   
\renewcommand{\thefigure}{A.\arabic{figure}} 
\renewcommand{\thetable}{A.\arabic{table}}


% --------------------------- 附录 --------------------------- %
% >> ------------------------ 附录 ------------------------ << %

\end{document}
